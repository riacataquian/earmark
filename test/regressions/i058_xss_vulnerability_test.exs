defmodule RegressionsTest do
  use ExUnit.Case
  #
  # Issue #58 https://github.com/pragdave/earmark/issues/58รท XSS Vulnerability
  #

  @moduletag :wip

  @blockquote """
  > hello <a href="javascript:">
  """
  test "javascript is escaped in link inside blockquote" do
    result = Earmark.to_html @blockquote
    assert result == """
    """
  end

  @scripttag """
  <script>...
  </script>
  """
  test "script tags are not allowed by default" do
    result = Earmark.to_html @scripttag
    assert result == """
    """
  end

  # test "script tags are allowed if safe is passed in" do
  #   result = Earmark.to_html @scripttag, html_safe: true
  #   assert result == """
  #   <script>...
  #   </script>
  #   """
  # end

end
